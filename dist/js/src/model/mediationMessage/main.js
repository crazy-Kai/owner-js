"use strict";define("src/model/mediationMessage/main",["common/jquery","common/myWidget","model/modal/main","model/ajax/main","common/validator","common/scroller"],function(require,exports,module){var $=require("common/jquery"),MyWidget=require("common/myWidget"),Modal=require("model/modal/main"),Ajax=require("model/ajax/main"),Validator=require("common/validator"),Scroller=require("common/scroller"),handlerbars=MyWidget.handlerbars,mmMessageTemple=handlerbars.compile(["<tr>",'<td width="65" valign="top">','<span class="fn-left fn-W50 fn-TAC fn-color-FFF fn-BGC-999">',"{{curUser}}","</span>","</td>","<td>","{{content}}","</td>",'<td width="120" align="right" valign="bottom">','{{formatData "yyyy/MM/dd HH:mm" gmtCreate}}',"</td>","</tr>"].join("")),MediationMessage=MyWidget.extend({clssName:"MediationMessage",attrs:{request:"/suit/suitMediation/save.json",pageParam:"#page-param"},events:{"click .JS-trigger-click-publish":function(){return this.mmPuhlishMessage()}},initProps:function(){var me=this;return me.mmMessageTable=me.$(".JS-target-message-table"),me.pageParam=me.jQuery(me.get("pageParam")),me.mmTextarea=me.$(".JS-target-textarea"),me.mmScroller=new Scroller({trigger:me.$(".JS-need-scroller")}),me.mmVal=Validator.use(me.element),me},setup:function(){},mmPuhlishMessage:function(){var me=this,ele=me.element.find('[name="mediationRecordDo.content"]');return/^[\s]+$/.test(ele.val())&&ele.val(""),me.mmVal.execute(function(isErr,errList){isErr?me.log(errList):Modal.confirm("提示","您确定要提交吗？",function(){new Ajax({request:me.get("request"),element:me.element,paramName:"paramMap",autoSubmit:!0,onAjaxSuccess:function(rtv,msg,res){me.mmMessageWrite(rtv),me.mmClearTextarea()}})})}),me},mmMessageWrite:function(json){var me=this;return me.mmMessageTable.prepend(mmMessageTemple($.extend(json,me.serialize(me.pageParam)))),me.mmScroller.reset(),me.redraw(me.mmMessageTable),me.mmTextarea.focus(),me},mmClearTextarea:function(){var me=this;return me.mmTextarea.val(""),me}});return MediationMessage});
"use strict";define("common/jquery",[],function(require,exports){return jQuery});